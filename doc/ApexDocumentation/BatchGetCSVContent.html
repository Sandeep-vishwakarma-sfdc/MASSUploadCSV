<html><head><script type='text/javascript' src='jquery-1.11.1.js'></script><script type='text/javascript' src='CollapsibleList.js'></script><script type='text/javascript' src='ApexDoc.js'></script><link rel='stylesheet' type='text/css' href='ApexDoc.css' /> </head><body><div class='topsection'><table><tr><td><img src='apex_doc_logo.png' style='border:1px solid #000;'/></td><td><h2 style='margin:0px;'>Project Demo</h2>Check out the gitHub project at:<br/><a href='http://github.com/SalesforceFoundation/ApexDoc'>http://github.com/SalesforceFoundation/ApexDoc</a><br/></td></tr></table></div><table width='100%'><tr><td colspan='2' style='text-align: center;' >Show: <input type='checkbox' checked='checked' id='cbxglobal' onclick='ToggleScope("global", this.checked );'>global</input>&nbsp;&nbsp;<input type='checkbox' checked='checked' id='cbxpublic' onclick='ToggleScope("public", this.checked );'>public</input>&nbsp;&nbsp;<input type='checkbox' checked='checked' id='cbxwebService' onclick='ToggleScope("webService", this.checked );'>webService</input>&nbsp;&nbsp;</td></tr><tr style='vertical-align:top;' ><td width='20%' vertical-align='top' ><div class='sidebar'><div class='navbar'><nav role='navigation'><ul id='mynavbar'><li id='idMenuindex'><a href='.' onclick="gotomenu('index.html', event);return false;" class='nav-item'>Home</a></li><li class='header' id='idMenunull'><a class='nav-item nav-section-title' href='.' onclick="gotomenu(document.location.href, event);return false;" class='nav-item'>Miscellaneous<span class='caret'></span></a></li><ul><li class='subitem classscopepublic' id='idMenuBatchGetCSVContent'><a href='.' onclick="gotomenu('BatchGetCSVContent.html', event);return false;" class='nav-item sub-nav-item scopepublic'>BatchGetCSVContent</a></li><li class='subitem classscopepublic' id='idMenuConnectToSharePoint'><a href='.' onclick="gotomenu('ConnectToSharePoint.html', event);return false;" class='nav-item sub-nav-item scopepublic'>ConnectToSharePoint</a></li><li class='subitem classscopepublic' id='idMenuContentVersionTriggerHelper'><a href='.' onclick="gotomenu('ContentVersionTriggerHelper.html', event);return false;" class='nav-item sub-nav-item scopepublic'>ContentVersionTriggerHelper</a></li><li class='subitem classscopepublic' id='idMenuContentVersionTriggerHelperTest'><a href='.' onclick="gotomenu('ContentVersionTriggerHelperTest.html', event);return false;" class='nav-item sub-nav-item scopepublic'>ContentVersionTriggerHelperTest</a></li><li class='subitem classscopepublic' id='idMenuGetSharePointFilesResponse'><a href='.' onclick="gotomenu('GetSharePointFilesResponse.html', event);return false;" class='nav-item sub-nav-item scopepublic'>GetSharePointFilesResponse</a></li><li class='subitem classscopepublic' id='idMenuITriggerHandler'><a href='.' onclick="gotomenu('ITriggerHandler.html', event);return false;" class='nav-item sub-nav-item scopepublic'>ITriggerHandler</a></li><li class='subitem classscopepublic' id='idMenuMassCSVReprocessLWC'><a href='.' onclick="gotomenu('MassCSVReprocessLWC.html', event);return false;" class='nav-item sub-nav-item scopepublic'>MassCSVReprocessLWC</a></li><li class='subitem classscopepublic' id='idMenuMassUploadCSVTriggerHandler'><a href='.' onclick="gotomenu('MassUploadCSVTriggerHandler.html', event);return false;" class='nav-item sub-nav-item scopepublic'>MassUploadCSVTriggerHandler</a></li><li class='subitem classscopepublic' id='idMenuMassUploadCSVTriggerTest'><a href='.' onclick="gotomenu('MassUploadCSVTriggerTest.html', event);return false;" class='nav-item sub-nav-item scopepublic'>MassUploadCSVTriggerTest</a></li><li class='subitem classscopepublic' id='idMenuMassUploadProcessAttachmentBatch'><a href='.' onclick="gotomenu('MassUploadProcessAttachmentBatch.html', event);return false;" class='nav-item sub-nav-item scopepublic'>MassUploadProcessAttachmentBatch</a></li><li class='subitem classscopepublic' id='idMenuMassUploadProcessAttachmentBatchHelper'><a href='.' onclick="gotomenu('MassUploadProcessAttachmentBatchHelper.html', event);return false;" class='nav-item sub-nav-item scopepublic'>MassUploadProcessAttachmentBatchHelper</a></li><li class='subitem classscopepublic' id='idMenuMockHttpSharepoint'><a href='.' onclick="gotomenu('MockHttpSharepoint.html', event);return false;" class='nav-item sub-nav-item scopepublic'>MockHttpSharepoint</a></li><li class='subitem classscopepublic' id='idMenuReadAndSplitAttachment'><a href='.' onclick="gotomenu('ReadAndSplitAttachment.html', event);return false;" class='nav-item sub-nav-item scopepublic'>ReadAndSplitAttachment</a></li><li class='subitem classscopepublic' id='idMenuReadAndSplitAttachmentTest'><a href='.' onclick="gotomenu('ReadAndSplitAttachmentTest.html', event);return false;" class='nav-item sub-nav-item scopepublic'>ReadAndSplitAttachmentTest</a></li><li class='subitem classscopepublic' id='idMenuSharepointSchedular'><a href='.' onclick="gotomenu('SharepointSchedular.html', event);return false;" class='nav-item sub-nav-item scopepublic'>SharepointSchedular</a></li><li class='subitem classscopepublic' id='idMenuSharepointSchedularTest'><a href='.' onclick="gotomenu('SharepointSchedularTest.html', event);return false;" class='nav-item sub-nav-item scopepublic'>SharepointSchedularTest</a></li><li class='subitem classscopepublic' id='idMenuTriggerDispatcher'><a href='.' onclick="gotomenu('TriggerDispatcher.html', event);return false;" class='nav-item sub-nav-item scopepublic'>TriggerDispatcher</a></li></ul></ul></nav></div></div></div></td><td class='contentTD'><h2 class='section-title'><a target='_blank' class='hostedSourceLink' href='BatchGetCSVContent.cls#L6'>BatchGetCSVContent</a></h2><div class='classSignature'><a target='_blank' class='hostedSourceLink' href='BatchGetCSVContent.cls#L6'>public with sharing class BatchGetCSVContent implements Database.Batchable&#60;Integration_Files__c&#62;,Database.AllowsCallouts</a></div><div class='classDetails'>This class takes foldername from SharePointSchedular and Create  Mass upload Records (Record type: Original) and assign Files to mass upload records you can see it in related list files.<br/><br/>Sandeep Vishwakarma &#60;sandeep.vishwakarma@skinternational.com&#62;</div><p/><h2 class='subsection-title'>Methods</h2><div class='subsection-container'> <ul class='methodTOC'><li class='methodscopepublic' ><a class='methodTOCEntry' href='#BatchGetCSVContent'>BatchGetCSVContent</a><div class='methodTOCDescription'> This is a constructor which take folder name as a input.</div></li><li class='methodscopepublic' ><a class='methodTOCEntry' href='#createFiles'>createFiles</a><div class='methodTOCDescription'> createFiles method is use to Create File for provided mass upload record with the provided content</div></li><li class='methodscopepublic' ><a class='methodTOCEntry' href='#createMassUpload'>createMassUpload</a><div class='methodTOCDescription'> createMassUpload method used to create mass upload record (Mass_Upload_CSV__c) of record type Original and status will be Draft.</div></li><li class='methodscopepublic' ><a class='methodTOCEntry' href='#csvContent'>csvContent</a><div class='methodTOCDescription'> This is csvContent method used to bring content of fileName provided as input from folderName provided as input which is stored on Microsoft sharepoint.</div></li><li class='methodscopepublic' ><a class='methodTOCEntry' href='#execute'>execute</a><div class='methodTOCDescription'> This is a execute method of batchable class. It process the list of Integration files coming from start method. It is used to create mass upload record of record type original by calling method createMassUpload.</div></li><li class='methodscopepublic' ><a class='methodTOCEntry' href='#finish'>finish</a><div class='methodTOCDescription'> This is a finish method It will run once all the mass upload record (i.e of type original) and their repective file content is created</div></li><li class='methodscopepublic' ><a class='methodTOCEntry' href='#getTypeFromFileName'>getTypeFromFileName</a><div class='methodTOCDescription'> getTypeFromFileName method used to get Type of file (i.e SalesDeduction,E2ECost etc)</div></li><li class='methodscopepublic' ><a class='methodTOCEntry' href='#start'>start</a><div class='methodTOCDescription'> This is a Start method of batchable class. It bring the Integration Files which are in Draft stage.</div></li></ul><div class='methodscopepublic' ><h2 class='methodHeader'><a id='BatchGetCSVContent'/>BatchGetCSVContent</h2><div class='methodSignature'><a target='_blank' class='hostedSourceLink' href='BatchGetCSVContent.cls#L14'>public BatchGetCSVContent(String folderName)</a></div><div class='methodDescription'> This is a constructor which take folder name as a input.</div><div class='methodSubTitle'>Parameters</div><div class='paramName'>folderName</div><div class='paramDescription'>The first String.</div><div class='methodSubTitle'>Return Value</div><div class='methodReturns'>No return</div></div><div class='methodscopepublic' ><h2 class='methodHeader'><a id='createFiles'/>createFiles</h2><div class='methodSignature'><a target='_blank' class='hostedSourceLink' href='BatchGetCSVContent.cls#L111'>public  void createFiles(Mass_Upload_CSV__c massupload,Blob content)</a></div><div class='methodDescription'> createFiles method is use to Create File for provided mass upload record with the provided content</div><div class='methodSubTitle'>Parameters</div><div class='paramName'>massupload</div><div class='paramDescription'>The first paramter Mass_Upload_CSV__c.</div><div class='paramName'>content</div><div class='paramDescription'>The Second paramter Blob.</div><div class='methodSubTitle'>Return Value</div><div class='methodReturns'>void</div></div><div class='methodscopepublic' ><h2 class='methodHeader'><a id='createMassUpload'/>createMassUpload</h2><div class='methodSignature'><a target='_blank' class='hostedSourceLink' href='BatchGetCSVContent.cls#L83'>public  Mass_Upload_CSV__c createMassUpload(String type,Integration_Files__c integrationFiles)</a></div><div class='methodDescription'> createMassUpload method used to create mass upload record (Mass_Upload_CSV__c) of record type Original and status will be Draft.</div><div class='methodSubTitle'>Parameters</div><div class='paramName'>type</div><div class='paramDescription'>The first paramter String.</div><div class='paramName'>integrationFiles</div><div class='paramDescription'>The Second paramter Integration_Files__c .</div><div class='methodSubTitle'>Return Value</div><div class='methodReturns'>It returns created mass upload record (Mass_Upload_CSV__c )</div></div><div class='methodscopepublic' ><h2 class='methodHeader'><a id='csvContent'/>csvContent</h2><div class='methodSignature'><a target='_blank' class='hostedSourceLink' href='BatchGetCSVContent.cls#L60'>public String csvContent(String folderName,String fileName)</a></div><div class='methodDescription'> This is csvContent method used to bring content of fileName provided as input from folderName provided as input which is stored on Microsoft sharepoint.</div><div class='methodSubTitle'>Parameters</div><div class='paramName'>folderName</div><div class='paramDescription'>The first paramter String.</div><div class='paramName'>fileName</div><div class='paramDescription'>The Second paramter String .</div><div class='methodSubTitle'>Return Value</div><div class='methodReturns'>It returns csv file content in string type.</div></div><div class='methodscopepublic' ><h2 class='methodHeader'><a id='execute'/>execute</h2><div class='methodSignature'><a target='_blank' class='hostedSourceLink' href='BatchGetCSVContent.cls#L35'>public void execute(Database.BatchableContext bc, List&#60;Integration_Files__c&#62; integrationFiles)</a></div><div class='methodDescription'> This is a execute method of batchable class. It process the list of Integration files coming from start method. It is used to create mass upload record of record type original by calling method createMassUpload.</div><div class='methodSubTitle'>Parameters</div><div class='paramName'>bc</div><div class='paramDescription'>The first paramter of type Database.BatchableContext.</div><div class='paramName'>integrationFiles</div><div class='paramDescription'>The second paramter of type List&#60;Integration_Files__c&#62;.</div><div class='methodSubTitle'>Return Value</div><div class='methodReturns'>It returns Iterable&#60;Integration_Files__c&#62;.</div></div><div class='methodscopepublic' ><h2 class='methodHeader'><a id='finish'/>finish</h2><div class='methodSignature'><a target='_blank' class='hostedSourceLink' href='BatchGetCSVContent.cls#L50'>public void finish(Database.BatchableContext bc)</a></div><div class='methodDescription'> This is a finish method It will run once all the mass upload record (i.e of type original) and their repective file content is created</div><div class='methodSubTitle'>Parameters</div><div class='paramName'>bc</div><div class='paramDescription'>The first paramter of type Database.BatchableContext.</div><div class='methodSubTitle'>Return Value</div><div class='methodReturns'>void</div></div><div class='methodscopepublic' ><h2 class='methodHeader'><a id='getTypeFromFileName'/>getTypeFromFileName</h2><div class='methodSignature'><a target='_blank' class='hostedSourceLink' href='BatchGetCSVContent.cls#L131'>public String getTypeFromFileName(String fileName)</a></div><div class='methodDescription'> getTypeFromFileName method used to get Type of file (i.e SalesDeduction,E2ECost etc)</div><div class='methodSubTitle'>Parameters</div><div class='paramName'>fileName</div><div class='paramDescription'>The first paramter String.</div><div class='methodSubTitle'>Return Value</div><div class='methodReturns'>It returns type of file</div></div><div class='methodscopepublic' ><h2 class='methodHeader'><a id='start'/>start</h2><div class='methodSignature'><a target='_blank' class='hostedSourceLink' href='BatchGetCSVContent.cls#L23'>public Iterable&#60;Integration_Files__c&#62; start(Database.BatchableContext bc)</a></div><div class='methodDescription'> This is a Start method of batchable class. It bring the Integration Files which are in Draft stage.</div><div class='methodSubTitle'>Parameters</div><div class='paramName'>bc</div><div class='paramDescription'>The first paramter of type Database.BatchableContext.</div><div class='methodSubTitle'>Return Value</div><div class='methodReturns'>It returns Iterable&#60;Integration_Files__c&#62;.</div></div></div></div></div></div></td></tr></table><hr/><center style='font-size:.8em;'><a href='http://github.com/SalesforceFoundation/ApexDoc' target='_blank'>Powered By ApexDoc</a></center></body></html>